<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Налаштування профілю</title>
    <link rel="stylesheet" href="/style/users/settings.css">
</head>
<body>

<!-- Спливаючі повідомлення -->
<% if (message) { %>
    <div id="success-toast" class="toast"><%= message %></div>
<% } %>

<header id="main-header">
        <div class="logo">
            <a href="/"> EcoGuard</a>
        </div>
        <div class="header-right-content">
            <nav>
            <% if (user) { %>
            <a href="/system" >Система</a>

            <% } %>
                <a href="/" class="active">Головна</a>
                <a href="/map">Карта Даних</a>
                <a href="/about-system">Про Систему</a>
                <a href="/contact">Контакти</a>
            </nav>
            <% if (user) { %>
                
                <div class="user-menu">
                    <button id="user-name"><%= user.name %> &#9662;</button>
                    <div class="dropdown-menu" id="dropdown-menu">
                        <a href="/dashboard">Панель приладів</a>
                        <a href="/profile">Мій профіль</a>
                        <a href="/settings">Налаштування</a>
                        <% if (user.role === "admin") { %>
                            <a href="/admin-panel">Панель Адміністратора</a>
                        <% } %>
                        <a href="/logout">Вийти</a>
                    </div>
                </div>
            <% } else { %>
                <div class="auth-buttons">
                    <a href="/login" class="login-btn">Увійти</a>
                    <a href="/register" class="signup-btn">Реєстрація</a>
                </div>
            <% } %>
        </div>
    </header>


<div class="settings-container">
    <h2>Налаштування профілю</h2>

    <!-- Фото профілю -->
   <!-- Фото профілю -->
<div class="profile-picture">
    <% let profilePic = user.profile_picture; %>
    <% if (!profilePic || !profilePic.startsWith('http')) { profilePic = 'https://nikkme.fra1.cdn.digitaloceanspaces.com/profiles/default-avatar.png'; } %>
    <img src="<%= profilePic %>" alt="Фото профілю" class="profile-pic">
</div>

    
    <form action="/upload-profile-pic" method="POST" enctype="multipart/form-data">
        <input type="file" name="profilePic" accept="image/webp" required>
        <button type="submit">Оновити фото</button>
    </form>
    
    
    

    <!-- Оновлення нікнейму -->
    <form action="/update-name" method="POST">
        <input type="text" name="newName" placeholder="Новий нікнейм" value="<%= user.name %>">
        <div class="form-group">
            <button type="submit">Оновити нікнейм</button>
        </div>
    </form>

    <!-- Оновлення пароля -->
    <form action="/update-password" method="POST">
        <input type="password" name="oldPassword" placeholder="Старий пароль">
        <input type="password" name="newPassword" placeholder="Новий пароль">
        <div class="form-group">
            <button type="submit">Оновити пароль</button>
        </div>
    </form>
</div>


    <footer>
        <p>© <%= new Date().getFullYear() %> EcoGuard. Програмна система моніторингу екологічного стану місцевості.</p>
        <p><a href="/privacy-policy">Політика конфіденційності</a> | <a href="/terms-of-use">Умови використання</a></p>
    </footer>

<script src="/js/users/settings.js" defer></script>
</body>
</html>
